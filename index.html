<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="vendor/bootstrap/dist/css/bootstrap.min.css" type="text/css" />
    <script type="text/javascript" src="vendor/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="vendor/bootstrap/dist/js/bootstrap.min.js"></script>
    <title>Calculadora de Ganancias</title>
    <style type="text/css">
        .mes {
            text-align : right;
        }
    </style>
    <script>
        
        var MINIMO_NO_IMPONIBLE = 42318;
        var CONYUGE = 39778;
        var FAMILIAR_A_CARGO = 19889;
        var HIJO = 19889;
        var ADICIONAL_4TA_CATEGORIA = 203126;
        
        var escalas = [
                {
                    desde : 120000,
                    hasta : 999999999999,
                    fijo : 28500,
                    porcentaje : 0.35
                },
                {
                    desde : 90000,
                    hasta : 120000,
                    fijo : 19200,
                    porcentaje : 0.31
                },
                {
                    desde : 60000,
                    hasta : 90000,
                    fijo : 11100,
                    porcentaje : 0.27
                },
                {
                    desde : 30000,
                    hasta : 60000,
                    fijo : 4200,
                    porcentaje : 0.23
                },
                {
                    desde : 20000,
                    hasta : 30000,
                    fijo : 2300,
                    porcentaje : 0.19
                },
                {
                    desde : 10000,
                    hasta : 20000,
                    fijo : 900,
                    porcentaje : 0.14
                },
                {
                    desde : 0,
                    hasta : 10000,
                    fijo : 0,
                    porcentaje : 0.09
                }
                
            ];
        
        $(function () {
           
           $('.mes').focusout(function (e) {
              var value = $(e.currentTarget).val();
              if (value.length == 0)
                $(e.currentTarget).val('0');
           });
           
           $('.mes').keydown(function (e) {
               
               if (e.keyCode == 9) {
                   console.log('Tab');
               }
           })
           
        });
        
        function calcular() {
            
            var conyuge = $('#conyuge').val() == 'on' ? true : false;
            var familiaresACargo = parseInt($('#familiar').val());
            var hijos = parseInt($('#hijos').val());
            var minimoNoImponibleAnual = MINIMO_NO_IMPONIBLE + ADICIONAL_4TA_CATEGORIA;
            minimoNoImponibleAnual += (conyuge) ? CONYUGE : 0;
            minimoNoImponibleAnual += familiaresACargo * FAMILIAR_A_CARGO;
            minimoNoImponibleAnual += hijos * HIJO;
            
            var brutos = [];
            brutos.push(parseInt($('#mes1').val()));
            brutos.push(parseInt($('#mes2').val()));
            brutos.push(parseInt($('#mes3').val()));
            brutos.push(parseInt($('#mes4').val()));
            brutos.push(parseInt($('#mes5').val()));
            brutos.push(parseInt($('#mes6').val()));
            brutos.push(parseInt($('#mes7').val()));
            brutos.push(parseInt($('#mes8').val()));
            brutos.push(parseInt($('#mes9').val()));
            brutos.push(parseInt($('#mes10').val()));
            brutos.push(parseInt($('#mes11').val()));
            brutos.push(parseInt($('#mes12').val()));
            
            var brutoAnual = 0;
            
            // Aguinaldo Anual
            var mejorBruto = 0;
            for (var i in brutos) {
                brutoAnual += brutos[i];
                if (brutos[i] > mejorBruto)
                    mejorBruto = brutos[i];
            }
            brutoAnual += mejorBruto;
            
            var netoAnual = brutoAnual * 0.83;
            var excedente = netoAnual - minimoNoImponibleAnual;
            
            var impuestoAnual = 0;
            var listo = false;
            for (var i = 0; i < escalas.length && !listo; i++) {
                
                if (excedente >= escalas[i].desde && excedente < escalas[i].hasta) {
                    console.log(escalas[i].porcentaje);
                    impuestoAnual = escalas[i].fijo + ((excedente - escalas[i].desde) * escalas[i].porcentaje);
                    listo = true;
                }
            }
            
            console.log('Neto Anual: %d',netoAnual);
            console.log('Minimo No imponible Anual: %d', minimoNoImponibleAnual);
            console.log('Execedente Anual: %d', excedente);
            console.log('Retencion Anual: %d', impuestoAnual);

        }
        
    </script>
</head>
<body>
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3>Calculadora de Ganancias</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes1">Enero</label><input type="number" name="mes1" id="mes1" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes2">Febrero</label><input type="number" name="mes2" id="mes2" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes3">Marzo</label><input type="number" name="mes3" id="mes3" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes4">Abril</label><input type="number" name="mes4" id="mes4" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes5">Mayo</label><input type="number" name="mes5" id="mes5" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes6">Junio</label><input type="number" name="mes6" id="mes6" class="form-control mes" value="0"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes7">Julio</label><input type="number" name="mes7" id="mes7" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes8">Agosto</label><input type="number" name="mes8" id="mes8" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes9">Septiembre</label><input type="number" name="mes9" id="mes9" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes10">Octubre</label><input type="number" name="mes10" id="mes10" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes11">Noviembre</label><input type="number" name="mes11" id="mes11" class="form-control mes" value="0"></div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group"><label for="mes12">Diciembre</label><input type="number" name="mes12" id="mes12" class="form-control mes" value="0"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-11">
                        <div class="col-md-2">
                            <div class="form-group">
                                <div class="checkbox">
                                    <label for="conyuge"><input type="checkbox" id="conyuge" name="conyuge">Conyuge</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-inline">
                                <label for="familiar">Familiar a Cargo</label>
                                <select name="familiar" id="familiar" class="form-control">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-inline">
                                <label for="hijos">Hijos</label>
                                <select name="hijos" id="hijos" class="form-control">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group" style="margin : 2%">
                            <button class="btn btn-success" id="calcular" onclick="calcular()">Calcular</button>
                        </div>
                    </div>
                </div>
                <br/>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4>Resultados</h4>
                    </div>
                    <div class="panel-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Concepto</th>
                                    <th>Enero</th>
                                    <th>Febrero</th>
                                    <th>Marzo</th>
                                    <th>Abril</th>
                                    <th>Mayo</th>
                                    <th>Junio</th>
                                    <th>Julio</th>
                                    <th>Agosto</th>
                                    <th>Septiembre</th>
                                    <th>Octubre</th>
                                    <th>Noviembre</th>
                                    <th>Diciembre</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="concepto">Sueldo Bruto</td>
                                    <td class="importe" id="sueldo-bruto1"></td>
                                    <td class="importe" id="sueldo-bruto2"></td>
                                    <td class="importe" id="sueldo-bruto3"></td>
                                    <td class="importe" id="sueldo-bruto4"></td>
                                    <td class="importe" id="sueldo-bruto5"></td>
                                    <td class="importe" id="sueldo-bruto6"></td>
                                    <td class="importe" id="sueldo-bruto7"></td>
                                    <td class="importe" id="sueldo-bruto8"></td>
                                    <td class="importe" id="sueldo-bruto9"></td>
                                    <td class="importe" id="sueldo-bruto10"></td>
                                    <td class="importe" id="sueldo-bruto11"></td>
                                    <td class="importe" id="sueldo-bruto12"></td>
                                </tr>
                                <tr>
                                    <td class="concepto">Aporte Jubilatorio</td>
                                    <td class="importe" id="aporte-jubilatorio1"></td>
                                    <td class="importe" id="aporte-jubilatorio2"></td>
                                    <td class="importe" id="aporte-jubilatorio3"></td>
                                    <td class="importe" id="aporte-jubilatorio4"></td>
                                    <td class="importe" id="aporte-jubilatorio5"></td>
                                    <td class="importe" id="aporte-jubilatorio6"></td>
                                    <td class="importe" id="aporte-jubilatorio7"></td>
                                    <td class="importe" id="aporte-jubilatorio8"></td>
                                    <td class="importe" id="aporte-jubilatorio9"></td>
                                    <td class="importe" id="aporte-jubilatorio10"></td>
                                    <td class="importe" id="aporte-jubilatorio11"></td>
                                    <td class="importe" id="aporte-jubilatorio12"></td>
                                </tr>
                                <tr>
                                    <td class="concepto">Obra Social</td>
                                    <td class="importe" id="obra-social1"></td>
                                    <td class="importe" id="obra-social2"></td>
                                    <td class="importe" id="obra-social3"></td>
                                    <td class="importe" id="obra-social4"></td>
                                    <td class="importe" id="obra-social5"></td>
                                    <td class="importe" id="obra-social6"></td>
                                    <td class="importe" id="obra-social7"></td>
                                    <td class="importe" id="obra-social8"></td>
                                    <td class="importe" id="obra-social9"></td>
                                    <td class="importe" id="obra-social10"></td>
                                    <td class="importe" id="obra-social11"></td>
                                    <td class="importe" id="obra-social12"></td>
                                </tr>
                                <tr>
                                    <td class="concepto">Ley 19032</td>
                                    <td class="importe" id="ley-190321"></td>
                                    <td class="importe" id="ley-190322"></td>
                                    <td class="importe" id="ley-190323"></td>
                                    <td class="importe" id="ley-190324"></td>
                                    <td class="importe" id="ley-190325"></td>
                                    <td class="importe" id="ley-190326"></td>
                                    <td class="importe" id="ley-190327"></td>
                                    <td class="importe" id="ley-190328"></td>
                                    <td class="importe" id="ley-190329"></td>
                                    <td class="importe" id="ley-1903210"></td>
                                    <td class="importe" id="ley-1903211"></td>
                                    <td class="importe" id="ley-1903212"></td>
                                </tr>
                                <tr>
                                    <td class="concepto">Imp. a las ganancias</td>
                                    <td class="importe" id="imp-ganancias1"></td>
                                    <td class="importe" id="imp-ganancias2"></td>
                                    <td class="importe" id="imp-ganancias3"></td>
                                    <td class="importe" id="imp-ganancias4"></td>
                                    <td class="importe" id="imp-ganancias5"></td>
                                    <td class="importe" id="imp-ganancias6"></td>
                                    <td class="importe" id="imp-ganancias7"></td>
                                    <td class="importe" id="imp-ganancias8"></td>
                                    <td class="importe" id="imp-ganancias9"></td>
                                    <td class="importe" id="imp-ganancias10"></td>
                                    <td class="importe" id="imp-ganancias11"></td>
                                    <td class="importe" id="imp-ganancias12"></td>
                                </tr>
                                <tr>
                                    <td class="concepto">Sueldo Neto</td>
                                    <td class="importe" id="sueldo-neto1"></td>
                                    <td class="importe" id="sueldo-neto2"></td>
                                    <td class="importe" id="sueldo-neto3"></td>
                                    <td class="importe" id="sueldo-neto4"></td>
                                    <td class="importe" id="sueldo-neto5"></td>
                                    <td class="importe" id="sueldo-neto6"></td>
                                    <td class="importe" id="sueldo-neto7"></td>
                                    <td class="importe" id="sueldo-neto8"></td>
                                    <td class="importe" id="sueldo-neto9"></td>
                                    <td class="importe" id="sueldo-neto10"></td>
                                    <td class="importe" id="sueldo-neto11"></td>
                                    <td class="importe" id="sueldo-neto12"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

</body>
</html>